
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>A brief introduction to FEniCS &#8212; mocafe 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/class.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/functions.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Prostate cancer phase field model" href="prostate_cancer2d.html" />
    <link rel="prev" title="Demo Gallery" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-demo-doc-introduction-to-fenics-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="a-brief-introduction-to-fenics">
<span id="fenics-intro"></span><span id="sphx-glr-demo-doc-introduction-to-fenics-py"></span><h1>A brief introduction to FEniCS<a class="headerlink" href="#a-brief-introduction-to-fenics" title="Permalink to this headline">¶</a></h1>
<p>This demo is ment to give a brief introduction to the FEniCS computing platform for the <em>mocafe</em> users who
never came across this software. For a complete understanding of this demo it is required to have a basic
understanding of partial differential equations (PDEs), finite element method (FEM), and Python scripting.</p>
<p>This demo is deliberately very brief, given the presence online of excellent and extensive tutorials. Just to
mention a few, you can find for free the book <a class="reference external" href="https://fenicsproject.org/tutorial/">The FEniCS Tutorial</a>
<span id="id1">[<a class="reference internal" href="../bib.html#id4" title="Hans Petter Langtangen and Anders Logg. Solving PDEs in Python. Springer, 2017. ISBN 978-3-319-52461-0. doi:10.1007/978-3-319-52462-7.">LL17</a>]</span>, a collection of
<a class="reference external" href="https://fenicsproject.org/olddocs/dolfin/1.3.0/python/demo/index.html">documented demos</a>, and the <a class="reference external" href="https://jorgensd.github.io/dolfinx-tutorial/">tutorial
created by J. S. Dokken</a> for the development version of FEniCS,
FEniCSx. In case you feel the need of a more gradual introduction to FEniCS, we recommend you those websites.</p>
<section id="what-is-fenics">
<h2>What is FEniCS<a class="headerlink" href="#what-is-fenics" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://fenicsproject.org/">FEniCS</a> <span id="id2">[<a class="reference internal" href="../bib.html#id9" title="Martin Alnæs, Jan Blechta, Johan Hake, August Johansson, Benjamin Kehlet, Anders Logg, Chris Richardson, Johannes Ring, Marie E Rognes, and Garth N Wells. The fenics project version 1.5. &lt;p&gt;Archive of Numerical Software, Vol 3:&lt;strong&gt;Starting Point and Frequency: &lt;/strong&gt;Year: 2013&lt;/p&gt;, 2015. URL: http://journals.ub.uni-heidelberg.de/index.php/ans/article/view/20553, doi:10.11588/ANS.2015.100.20553.">ABH+15</a>]</span> is a popular open source computing platform for solving PDEs,
mainly using the Finite Element Method. FEniCS provides high level Python and C++ interfaces together with access to
powerful algebra backend, ensuring both efficiency and usability.</p>
</section>
<section id="the-basic-fenics-workflow">
<h2>The basic FEniCS workflow<a class="headerlink" href="#the-basic-fenics-workflow" title="Permalink to this headline">¶</a></h2>
<p>Every FEniCS script follows a general workflow to solve PDEs that is summarized in the following. See also the figure
below for a brief summary</p>
<ol class="arabic simple" start="0">
<li><p><strong>Initial setup</strong>. The operations here depend on the problem you’re solving but, in general, it is a good
practice to define some general variables at the beginning of the script. Also, this might be the good place
for setting up loggers, files to store data, and so on.</p></li>
<li><p><strong>Mesh definition or import</strong>. Before solving any PDE problem, you need to define the space where you want to
solve it. FEniCS has built-in methods to generate simple meshes, such as 2D rectangles or 3D cubes. However, it
is also possible (and often more interesting) to import any given mesh (e.g. a 3D model of a gear).</p></li>
<li><p><strong>Definition of the spatial discretization</strong>. Then, it is useful to define how you want your PDE to be discretized
in space choosing the type of Finite Element to use. This might be a critical choice for some problems.</p></li>
<li><p><strong>Definition of initial and boundary conditions</strong>.</p></li>
<li><p><strong>Definition of the weak form</strong>. One of the greatest things in FEniCS is the Unified Form language (UFL)
<span id="id3">[<a class="reference internal" href="../bib.html#id8" title="Martin S. Alnæs, Anders Logg, Kristian B. Ølgaard, Marie E. Rognes, and Garth N. Wells. Unified form language: a domain-specific language for weak formulations of partial differential equations. ACM Trans. Math. Softw., mar 2014. URL: https://doi.org/10.1145/2566630, doi:10.1145/2566630.">AlnaesLOlgaard+14</a>]</span>, which makes the coding of the PDE weak form very close to the mathematical language.</p></li>
<li><p><strong>Problem solution</strong>. The actual solution of the PDE system. This might be an iteration in time, in case the PDE
system you’re considering is time-dependent.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/workflow.png"><img alt="../_images/workflow.png" src="../_images/workflow.png" style="width: 600px;" /></a>
<p>We’re going to see this very workflow in practice in the next section.</p>
</section>
<section id="the-diffusion-or-heat-equation-solved-with-fenics">
<h2>The diffusion (or <em>heat</em>) equation solved with FEniCS<a class="headerlink" href="#the-diffusion-or-heat-equation-solved-with-fenics" title="Permalink to this headline">¶</a></h2>
<p>The simplest time-variant PDE is the so-called <em>diffusion equation</em> (or <em>heat equation</em>) which is used both to describe
the diffusion of a chemical in a fluid (e.g. salt in water) and the evolution of heat distribution in a conductor.</p>
<p>The equation reads:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}\frac{\partial u}{\partial t} = D \nabla^2 u &amp; \quad \textrm{in} \; \Omega \\\end{split}\\\begin{split}u(t=0) = u_0 &amp; \quad \textrm{in} \; \Omega \\\end{split}\\\begin{split}\nabla u \cdot n = 0 &amp; \quad \textrm{in} \; \Gamma \\\end{split}\end{aligned}\end{align} \]</div>
<p>Where:</p>
<ul class="simple">
<li><p>the first row is the actual PDE, which is defined on the entire spatial domain <span class="math notranslate nohighlight">\(\Omega\)</span>;</p></li>
<li><p>the second row represents the initial condition (which will be discussed in detail below);</p></li>
<li><p>and the third row represents the boundary condition (set to natural Neumann), which is of course
defined on the boundary <span class="math notranslate nohighlight">\(\Gamma\)</span>.</p></li>
</ul>
<p>Solving this problem in FEniCS requires just a few lines of Python code. Let’s see the implementation in detail.</p>
<section id="initial-setup">
<h3>Initial setup<a class="headerlink" href="#initial-setup" title="Permalink to this headline">¶</a></h3>
<p>In this simple case we just import the FEniCS package and create an <code class="docutils literal notranslate"><span class="pre">.xdmf</span></code> file, which will used for storing the
solution of our problem in time. You can open this kind of file with the software
<a class="reference external" href="https://www.paraview.org/">Paraview</a>, which is one of the recommended ways to visualize results obtained with FEniCS.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fenics</span>

<span class="c1"># create file</span>
<span class="n">u_xdmf</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">XDMFFile</span><span class="p">(</span><span class="s2">&quot;./demo_out/introduction_to_fenics/u.xdmf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="mesh-definition">
<h3>Mesh definition<a class="headerlink" href="#mesh-definition" title="Permalink to this headline">¶</a></h3>
<p>Here we use one of the FEniCS builtin function to create a simple square mesh of side 1. Notice that you can
specify the number of elements for each side (in this case, 32 x 32).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mesh</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">UnitSquareMesh</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spatial-discretization">
<h3>Spatial discretization<a class="headerlink" href="#spatial-discretization" title="Permalink to this headline">¶</a></h3>
<p>Then, we can choose how to approximate the solution of our PDE in space or, in FEM-terms, which kind of finite
element we need for solving our problem. It is not simple to explain a few words what a finite element is; simply
put, the kind of finite element specifies the class of piece-wise functions we want to use to approximate the solution
of our PDE of interest.</p>
<p>However, choosing the kind of finite element to use is extremely simple with the
<code class="docutils literal notranslate"><span class="pre">FunctionSpace</span></code> class in FEniCS. Below, with a single line of code, we generate the finite elements for our mesh,
specifying that we want Lagrange elements of degree 1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">V</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;Lagrange&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="initial-and-boundary-conditions">
<h3>Initial and boundary conditions<a class="headerlink" href="#initial-and-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>To clearly visualize the behaviour of the diffusion equation, we decided to have a simple circle as initial condition.
Physically-speaking, this is like considering an initial situation where a chemical is all concentrated in a circle
at the center of the domain.</p>
<p>To define this initial condition, we can use a so-called <code class="docutils literal notranslate"><span class="pre">Expression</span></code>, which is nothing more than a mathematical
expression written in C++. If you understand the basics of C, you can see that the input of the following object
is a C string defining a mathematical function, which is 1 inside a circle centered in (<code class="docutils literal notranslate"><span class="pre">c_x</span></code>, <code class="docutils literal notranslate"><span class="pre">c_y</span></code>), and 0
outside.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u_0_exp</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span><span class="s2">&quot;(pow(x[0] - c_x, 2) + pow(x[1] - c_y, 2) &lt;= pow(r, 2)) ? 1. : 0.&quot;</span><span class="p">,</span>
                            <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">c_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">c_y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">Expression</span></code>, however, is just a “symbolic” representation of our initial condition. In order to translate
it in an actual function, discretized in space according to our problem, we need to project it in our function space.</p>
<p>FEniCS has a built in function to do so, which is called, indeed, <code class="docutils literal notranslate"><span class="pre">project</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u_0</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">u_0_exp</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
<p>Regarding the boundary condition, we need no code to implement natural Neumann conditions in FEniCS because it is the
default setup. For different boundary conditions, you’re invited to check specific tutorials.</p>
<p>Finally, it is useful to store this initial condition in the <code class="docutils literal notranslate"><span class="pre">.xdmf</span></code> file we defined above, simply calling the
method <code class="docutils literal notranslate"><span class="pre">write(phi0,</span> <span class="pre">0)</span></code>. The second argument, 0, just represent the fact that
this is the value of the function at time 0. As we’re going to see in the simulation, the file <code class="docutils literal notranslate"><span class="pre">phi_xdmf</span></code> can
collect the values of phi for each time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">u_xdmf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">u_0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="weak-form-definition">
<h3>Weak form definition<a class="headerlink" href="#weak-form-definition" title="Permalink to this headline">¶</a></h3>
<p>The definition of the weak form of our PDE of interest is the starting point of the finite elment metod. Briefly,
the weak form is just a mathematical problem, derived from the original PDE, of which solution is an approximation
of our PDE of interest in a given function space <span class="math notranslate nohighlight">\(V\)</span>.</p>
<p>For people experienced in weak form definition is very simple to derive the one for the diffusion equation.
The discretization of the PDE in time with backward Euler leads to the following semi-discrete equation:</p>
<div class="math notranslate nohighlight">
\[\frac{u - u_0}{dt} - D \nabla^2 u = 0\]</div>
<p>And the weak form of this problem can be written in the canonical form:</p>
<div class="math notranslate nohighlight">
\[a(u, v) = L(v)\]</div>
<p>Where <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(L\)</span> are defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}a(u, v) &amp; = \int_{\Omega} \frac{u}{dt} \cdot v \cdot dx + \int_{\Omega} D \cdot \nabla u
\cdot \nabla v \cdot dx \\
L(v) &amp; = \int_{\Omega} \frac{u_0}{dt} \cdot v \cdot dx \\\end{split}\]</div>
<p>In the following, we translate this mathematical equation into scientific code leveraging one of the best feature of
FEniCS: the Unified Form Language (UFL). Indeed, you can see yourself that the definition of a and L is very close
to the actual mathematical formula.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span> <span class="o">*</span> <span class="n">fenics</span><span class="o">.</span><span class="n">dx</span> <span class="o">+</span> <span class="n">D</span> <span class="o">*</span> <span class="n">fenics</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">fenics</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">fenics</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="o">*</span> <span class="n">fenics</span><span class="o">.</span><span class="n">dx</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="n">u_0</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span> <span class="o">*</span> <span class="n">fenics</span><span class="o">.</span><span class="n">dx</span>

<span class="c1"># From this code, FEniCS is able to efficiently construct all the data structures needed to get our</span>
<span class="c1"># solution at each time step. If you wank to know more about this topic, you are again encouraged to have a look to The</span>
<span class="c1"># Fenics Tutorial to start :cite:`LangtangenLogg2017`.</span>
</pre></div>
</div>
</section>
<section id="problem-solution">
<h3>Problem solution<a class="headerlink" href="#problem-solution" title="Permalink to this headline">¶</a></h3>
<p>The last thing to do is to just solve our differential equation.</p>
<p>Since the equation is time-dependent, we need to iterate in time and solve for each time step the equation using the
following <code class="docutils literal notranslate"><span class="pre">for</span></code> loop:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
    <span class="c1"># update time</span>
    <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
    <span class="c1"># compute solution at current time step</span>
    <span class="n">fenics</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">L</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
    <span class="c1"># assign new solution to old</span>
    <span class="n">fenics</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">u_0</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
    <span class="c1"># save solution for the current time step</span>
    <span class="n">u_xdmf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">u_0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that also here the flow is very basic:</p>
<ul class="simple">
<li><p>we update time;</p></li>
<li><p>we call the FEniCS function <code class="docutils literal notranslate"><span class="pre">solve</span></code> to solve the equation (storing the result on the variable u);</p></li>
<li><p>we assign the result to u_0 (for the following time step);</p></li>
<li><p>and we store the solution to our <code class="docutils literal notranslate"><span class="pre">.xdmf</span></code> file.</p></li>
</ul>
<p>However, this basic method should be used with care: it works perfectly
with simple PDEs, but sometimes the “black-box” function <code class="docutils literal notranslate"><span class="pre">solve</span></code> is not the most efficient way compute our solution.
In those cases, it is recommended to use more advanced techniques. In other tutorials we will show how to use
different solution algorithms in FEniCS.</p>
<p>Below you can find an animation of the result of this script:</p>
<figure class="align-default">
<img alt="../_images/diffusion.gif" src="../_images/diffusion.gif" />
</figure>
</section>
</section>
<section id="full-code">
<h2>Full code<a class="headerlink" href="#full-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fenics</span>

<span class="c1"># create file</span>
<span class="n">u_xdmf</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">XDMFFile</span><span class="p">(</span><span class="s2">&quot;./demo_out/introduction_to_fenics/u.xdmf&quot;</span><span class="p">)</span>

<span class="n">mesh</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">UnitSquareMesh</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>

<span class="n">V</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;Lagrange&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">u_0_exp</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">Expression</span><span class="p">(</span><span class="s2">&quot;(pow(x[0] - c_x, 2) + pow(x[1] - c_y, 2) &lt;= pow(r, 2)) ? 1. : 0.&quot;</span><span class="p">,</span>
                          <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                          <span class="n">c_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">c_y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">u_0</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">u_0_exp</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">u_xdmf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">u_0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="n">D</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span> <span class="o">*</span> <span class="n">fenics</span><span class="o">.</span><span class="n">dx</span> <span class="o">+</span> <span class="n">D</span> <span class="o">*</span> <span class="n">fenics</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">fenics</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">fenics</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="o">*</span> <span class="n">fenics</span><span class="o">.</span><span class="n">dx</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="n">u_0</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span> <span class="o">*</span> <span class="n">fenics</span><span class="o">.</span><span class="n">dx</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">fenics</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
  <span class="c1"># update time</span>
  <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
  <span class="c1"># compute solution at current time step</span>
  <span class="n">fenics</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">L</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
  <span class="c1"># assign new solution to old</span>
  <span class="n">fenics</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">u_0</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
  <span class="c1"># save solution for the current time step</span>
  <span class="n">u_xdmf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">u_0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.000 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-demo-doc-introduction-to-fenics-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/716221c6f6c2a8aef89d5e9951338694/introduction_to_fenics.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">introduction_to_fenics.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/78c443defb7725b2085b844d21398103/introduction_to_fenics.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">introduction_to_fenics.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/200mocafe_logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">mocafe</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Demo Gallery</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">A brief introduction to FEniCS</a></li>
<li class="toctree-l2"><a class="reference internal" href="prostate_cancer2d.html">Prostate cancer phase field model</a></li>
<li class="toctree-l2"><a class="reference internal" href="angiogenesis_2d.html">Angiogenesis phase field model</a></li>
<li class="toctree-l2"><a class="reference internal" href="prostate_cancer3d.html">Prostate cancer phase field 3D model</a></li>
<li class="toctree-l2"><a class="reference internal" href="angiogenesis_3d.html">Angiogenesis Phase Field Model in 3D</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_documentation.html">Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bib.html">Bibliography</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Demo Gallery</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Demo Gallery</a></li>
      <li>Next: <a href="prostate_cancer2d.html" title="next chapter">Prostate cancer phase field model</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Franco Pradelli.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/demo_doc/introduction_to_fenics.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>